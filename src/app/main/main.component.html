<div class="main">

    <div id="ontology_rules" class="main_ontology_rules">
        <div class="left">
            <div class="rule_ontology">
                <div>
                    <h2><b>Please Enter Trigger Action Programs:</b></h2>

                    <textarea class="textarea"
                        placeholder="Please enter 'IF...THEN...', such as 'IF Door.dopen THEN M.heatoffPulse '"
                        [(ngModel)]="ruleText">
                    </textarea>
                    <div class="button-group">
                        <!-- 上传环境本体 -->
                        <button class="upload button">UploadOntology
                            <input class="change" type="file" ng2FileSelect [uploader]="modelUploader"
                                (change)="uploadModelFile($event)" />
                        </button>
                        <!-- 上传location和deviceInformation的property文件 -->
                        <button class="upload button">UploadProperty
                            <input class="change" type="file" ng2FileSelect [uploader]="propertyUploader"
                                (change)="uploadPropertyFile($event)" />
                        </button>
                        <div class="simulation_time">
                            <label style="color: rgb(43, 42, 42);">simulation time:
                                <input [(ngModel)]="simulationTime" class="simulation_time_input" type="number"
                                    min="100"
                                    oninput="this.value=this.value.replace(/\D/g);if(this.value.length>4)this.value=this.value.slice(0,4)">
                                s
                            </label>
                        </div>

                        <button class="analys_button" (click)="getStaticAnalysisResult()">Static Analysis</button>
                        <button class="analys_button" (click)="generateAllSystemModels()">Generate Models</button>
                        <button class="analys_button" (click)="scenariosSimulation()">Simulate</button>
                    </div>

                    <!-- <form  method="post" enctype="multipart/form-data" >
                            <label>choose ontology:</label>
                            <input type="file" name="file" accept=".xml" class="chooseFile_c"> 
                            
                            <input type="submit" class="submit_button"><br>
                            
                       </form> -->


                </div>
            </div>
            <!-- <app-rules-ontology class="rule_ontology"></app-rules-ontology> -->
        </div>



        <div class="right">
            <div id="simulation">
                <h2><b>Simulation Scenes:</b></h2>
                <div class="random-range">
                    <!-- <div echarts [options]="options | async" class="demo-chart"></div> -->
                    <div class="scenes-scope" id="all_scenes_tree">
                        <div class="scrollbar">
                            <!-- <div class="echarts_scale"> -->
                                <!-- <app-echarts-all-scenes class="scrollbar" [option]="scenesTreeOption"></app-echarts-all-scenes> -->
                                <div id="scenesTreeid" class="scenes_tree_scale" echarts [options]=scenesTreeOption>
                                </div>
                            <!-- </div> -->

                        </div>


                    </div>
                    <div class="scenes-scope" id="scenes_rules">
                        <!-- <app-echarts-all-scenes-rules-analys></app-echarts-all-scenes-rules-analys> -->
                        <div id="scenesRulesBarid" echarts [options]="scenesRulesOption" class="scenes_rules_scale">
                        </div>
                    </div>

                    <div class="scenes-scope" id="rules_scenes">
                        <div id="ruleScenesBarid" class="rules_scenes_scale" echarts [options]=rulesScenesOption></div>
                    </div>


                </div>
                <div class="button-group">
                    <button class="button" (click)="showScenarioTree()">Show Scenes Tree</button>
                    
                    <button class="button" (click)="showScenesRulesResults()">Show Scenes Rules</button>
                    <button class="button" (click)="showRulesScenesResults()">Show Rules Scenes</button>
                    <!-- <button class="button" [routerLink]="['/scene-details']" [queryParams]="{selectedSceneName:selectedSceneName,scenes:scenes}" (click)="toSceneDetail()">Scene Details</button> -->
                    <!-- <button class="button" (click)="toAllSceneDetail()">All Analysis</button> -->
                    <button class="button" (click)="toRuleAnalysis()">Dynamic Analysis</button>
                    <!-- <button class="button" routerLink="/ifd-plan">Show IFD</button> -->
                    <div ng-view></div>
                </div>

            </div>
            <div id="static">
                <h2><b>Static Analysis Result:</b></h2>
                <div class="random-range">
                    <!-- <div echarts [options]="options | async" class="demo-chart"></div> -->
                    <div class="scenes-scope" >
                        <div class="scrollbar">
                            <div *ngIf="staticAnalysisResult!=null">
                                <div *ngIf="staticAnalysisResult.incorrectRules.length>0">
                                    <b style="font-size: x-large;color: brown;">Incorrect rules:</b>
                                    <ul *ngFor="let incorrectRule of staticAnalysisResult.incorrectRules">
                                        <li style="list-style-type: none;color: black;">{{incorrectRule.rule.ruleName}}: {{incorrectRule.rule.ruleContent}}<br>
                                            <b style="color: brown;">Reason: {{incorrectRule.reason}}</b>
                                        </li>
                                    </ul>
                                </div>
                                <div *ngIf="staticAnalysisResult.unusedRules.length>0">
                                    <b style="font-size: x-large;color: brown;">Unused rules:</b>
                                    <ul *ngFor="let unusedRule of staticAnalysisResult.unusedRules">
                                        <li style="list-style-type: none;color: black;"><b>{{unusedRule.rule.ruleName}}</b>: {{unusedRule.rule.ruleContent}} <br>
                                            <b style="color: brown;">Reason: {{unusedRule.reason}}</b>
                                        </li>
                                    </ul>
                                </div>
                                <div *ngIf="staticAnalysisResult.redundantRules.length>0">
                                    <b style="font-size: x-large;color: brown;">Redundant rules:</b>
                                    <ul *ngFor="let redundantRules of staticAnalysisResult.redundantRules">
                                        <li><b>{{redundantRules[0].ruleName}}</b>: {{redundantRules[0].ruleContent}} <b style="color: brown;"> is redundant with</b></li>
                                        
                                        <li *ngFor="let rule of redundantRules;index as i" style="list-style-type: none">
                                            <div *ngIf="i>0">
                                                <b>{{rule.ruleName}}</b>: {{rule.ruleContent}}
                                            </div>
                                        </li>
                                        
                                    </ul>
                                </div>
                                <div *ngIf="staticAnalysisResult.incompleteness.length>0">
                                    <b style="font-size: x-large;color: brown;">Incompleteness:</b>
                                    <ul *ngFor="let incomplete of staticAnalysisResult.incompleteness">
                                        <li><b style="color: brown;">{{incomplete}}</b></li>
                                        
                                        
                                        
                                    </ul>
                                </div>
                            </div>

                            
                        </div>


                    </div>
                    


                </div>
                <div class="button-group">
                    <button class="button" (click)="simulationResults()">Simulation Results</button>
                    

                    <div ng-view></div>
                </div>
            </div>
        </div>

    </div>
    





</div>